# summary table of the model
summary(model_with_trend)
## trying the transformation on trends
with_trends_full %>% View
# trend 1
# suvs_trends <- read_csv("trucks_2004_2011.csv")
# names1<- names(suvs_trends)
# suvs_trends <- suvs_trends %>%
#   rename(suvs = names1[2],
#          Period = Month)
# trend 2
insurance_trends <- read_csv("trucks_suvs.csv")
names2 <- names(insurance_trends)
insurance_trends <- insurance_trends %>%
rename(insurance = names2[2],
Period = Month)
unadj_full <- sales %>% filter(Period <= "2011-07-01")
# trends_full <- left_join(insurance_trends, suvs_trends, by = "Period") %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
trends_full <- insurance_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
with_trends_full <- left_join(unadj_full, trends_full, by = "Period") %>% rename(sales = Value)
with_trends_full$sales = log(as.numeric(with_trends_full$sales))
# apply lm(). lag() is used to capture y_t-1 and y_t-12
model1 <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12))
#the summary of the model
summary(model1)
# model with trends
model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs + insurance)
model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) +  insurance)
# summary table of the model
summary(model_with_trend)
# trend 1
suvs_trends <- read_csv("trucks_2004_2011.csv")
names1<- names(suvs_trends)
suvs_trends <- suvs_trends %>%
rename(suvs = names1[2],
Period = Month)
# trend 2
insurance_trends <- read_csv("vehicle_insurance.csv")
names2 <- names(insurance_trends)
insurance_trends <- insurance_trends %>%
rename(insurance = names2[2],
Period = Month)
unadj_full <- sales %>% filter(Period <= "2011-07-01")
trends_full <- left_join(insurance_trends, suvs_trends, by = "Period") %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
#trends_full <- insurance_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
with_trends_full <- left_join(unadj_full, trends_full, by = "Period") %>% rename(sales = Value)
with_trends_full$sales = log(as.numeric(with_trends_full$sales))
# apply lm(). lag() is used to capture y_t-1 and y_t-12
model1 <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12))
#the summary of the model
summary(model1)
# model with trends
model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs + insurance)
# summary table of the model
summary(model_with_trend)
## trying the transformation on trends
#with_trends_full %>% View
insurance_trends <- insurance_trends %>%
rename(insurance = names2[2],
Period = Month) %>%
mutate(insurance=(insurance-52)/100)
# trend 1
suvs_trends <- read_csv("trucks_2004_2011.csv")
names1<- names(suvs_trends)
suvs_trends <- suvs_trends %>%
rename(suvs = names1[2],
Period = Month)
# trend 2
insurance_trends <- read_csv("vehicle_insurance.csv")
names2 <- names(insurance_trends)
insurance_trends <- insurance_trends %>%
rename(insurance = names2[2],
Period = Month) %>%
mutate(insurance=(insurance-52)/100)
unadj_full <- sales %>% filter(Period <= "2011-07-01")
trends_full <- left_join(insurance_trends, suvs_trends, by = "Period") %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
with_trends_full <- left_join(unadj_full, trends_full, by = "Period") %>% rename(sales = Value)
with_trends_full$sales = log(as.numeric(with_trends_full$sales))
# apply lm(). lag() is used to capture y_t-1 and y_t-12
model1 <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12))
#the summary of the model
summary(model1)
model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs + insurance)
# summary table of the model
summary(model_with_trend)
# trend 1
suvs_trends <- read_csv("trucks_2004_2011.csv")
names1<- names(suvs_trends)
suvs_trends <- suvs_trends %>%
rename(suvs = names1[2],
Period = Month)
# trend 2
insurance_trends <- read_csv("vehicle_insurance.csv")
names2 <- names(insurance_trends)
insurance_trends <- insurance_trends %>%
rename(insurance = names2[2],
Period = Month) %>%
mutate(insurance=(insurance-insuance[1])/100)
# trend 2
insurance_trends <- read_csv("vehicle_insurance.csv")
names2 <- names(insurance_trends)
insurance_trends <- insurance_trends %>%
rename(insurance = names2[2],
Period = Month) %>%
mutate(insurance=(insurance-insurance[1])/100)
unadj_full <- sales %>% filter(Period <= "2011-07-01")
trends_full <- left_join(insurance_trends, suvs_trends, by = "Period") %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
with_trends_full <- left_join(unadj_full, trends_full, by = "Period") %>% rename(sales = Value)
with_trends_full$sales = log(as.numeric(with_trends_full$sales))
# apply lm(). lag() is used to capture y_t-1 and y_t-12
model1 <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12))
#the summary of the model
summary(model1)
model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs + insurance)
# summary table of the model
summary(model_with_trend)
#with_trends_full %>% View
#the summary of the model
summary(model1)
model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs + insurance)
# summary table of the model
summary(model_with_trend)
# trend 1
suvs_trends <- read_csv("trucks_2004_2011.csv")
names1<- names(suvs_trends)
suvs_trends <- suvs_trends %>%
rename(suvs = names1[2],
Period = Month) %>%
mutate(suvs = (suvs-suvs[1])/max(suvs))
View(suvs_trends)
# trend 1
suvs_trends <- read_csv("trucks_2004_2011.csv")
names1<- names(suvs_trends)
suvs_trends <- suvs_trends %>%
rename(suvs = names1[2],
Period = Month) %>%
mutate(suvs = (suvs-suvs[1])/max(suvs))
# trend 2
insurance_trends <- read_csv("vehicle_insurance.csv")
names2 <- names(insurance_trends)
insurance_trends <- insurance_trends %>%
rename(insurance = names2[2],
Period = Month) %>%
mutate(insurance=(insurance-insurance[1])/100)
unadj_full <- sales %>% filter(Period <= "2011-07-01")
trends_full <- left_join(insurance_trends, suvs_trends, by = "Period") %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
with_trends_full <- left_join(unadj_full, trends_full, by = "Period") %>% rename(sales = Value)
with_trends_full$sales = log(as.numeric(with_trends_full$sales))
# apply lm(). lag() is used to capture y_t-1 and y_t-12
model1 <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12))
#the summary of the model
summary(model1)
model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs + insurance)
# summary table of the model
summary(model_with_trend)
#trends_full <- insurance_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
trends_full <- suvs_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
with_trends_full <- left_join(unadj_full, trends_full, by = "Period") %>% rename(sales = Value)
with_trends_full$sales = log(as.numeric(with_trends_full$sales))
# apply lm(). lag() is used to capture y_t-1 and y_t-12
model1 <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12))
#the summary of the model
summary(model1)
model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs)
# summary table of the model
summary(model_with_trend)
View(validate_data)
View(with_trends_full)
View(com_data)
View(actual_unajusted)
View(google_trends)
# trend 1
suvs_trends <- read_csv("trucks_2004_2011.csv")
names1<- names(suvs_trends)
suvs_trends <- suvs_trends %>%
rename(suvs = names1[2],
Period = Month) %>%
mutate(suvs = (suvs-suvs[1])/max(suvs))
# trend 2
insurance_trends <- read_csv("vehicle_insurance.csv")
names2 <- names(insurance_trends)
insurance_trends <- insurance_trends %>%
rename(insurance = names2[2],
Period = Month) %>%
mutate(insurance=(insurance-insurance[1])/100)
unadj_full <- sales %>% filter(Period <= "2011-07-01")
trends_full <- left_join(insurance_trends, suvs_trends, by = "Period") %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
#trends_full <- insurance_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
#trends_full <- suvs_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
with_trends_full <- left_join(unadj_full, trends_full, by = "Period") %>% rename(sales = Value)
with_trends_full$sales = log(as.numeric(with_trends_full$sales))
# apply lm(). lag() is used to capture y_t-1 and y_t-12
model1 <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12))
#the summary of the model
summary(model1)
# model with trends
model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs + insurance)
# model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs)
# summary table of the model
summary(model_with_trend)
## trying the transformation on trends
#with_trends_full %>% View
# trend 1
suvs_trends <- read_csv("trucks_2004_2011.csv")
names1<- names(suvs_trends)
suvs_trends <- suvs_trends %>%
rename(suvs = names1[2],
Period = Month) %>%
mutate(suvs = (suvs-suvs[1])/max(suvs))
# trend 2
insurance_trends <- read_csv("auto_insurance.csv")
names2 <- names(insurance_trends)
insurance_trends <- insurance_trends %>%
rename(insurance = names2[2],
Period = Month) %>%
mutate(insurance=(insurance-insurance[1])/100)
unadj_full <- sales %>% filter(Period <= "2011-07-01")
trends_full <- left_join(insurance_trends, suvs_trends, by = "Period") %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
#trends_full <- insurance_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
#trends_full <- suvs_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
with_trends_full <- left_join(unadj_full, trends_full, by = "Period") %>% rename(sales = Value)
with_trends_full$sales = log(as.numeric(with_trends_full$sales))
# apply lm(). lag() is used to capture y_t-1 and y_t-12
model1 <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12))
#the summary of the model
summary(model1)
# model with trends
model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs + insurance)
# model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs)
# summary table of the model
summary(model_with_trend)
## trying the transformation on trends
#with_trends_full %>% View
# trend 1
suvs_trends <- read_csv("trucks_2004_2011.csv")
names1<- names(suvs_trends)
suvs_trends <- suvs_trends %>%
rename(suvs = names1[2],
Period = Month) %>%
mutate(suvs = (suvs-suvs[1])/max(suvs))
# trend 2
insurance_trends <- read_csv("auto_insurance_all.csv")
names2 <- names(insurance_trends)
insurance_trends <- insurance_trends %>%
rename(insurance = names2[2],
Period = Month) %>%
mutate(insurance=(insurance-insurance[1])/100)
unadj_full <- sales %>% filter(Period <= "2011-07-01")
trends_full <- left_join(insurance_trends, suvs_trends, by = "Period") %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
#trends_full <- insurance_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
#trends_full <- suvs_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
with_trends_full <- left_join(unadj_full, trends_full, by = "Period") %>% rename(sales = Value)
with_trends_full$sales = log(as.numeric(with_trends_full$sales))
# apply lm(). lag() is used to capture y_t-1 and y_t-12
model1 <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12))
#the summary of the model
summary(model1)
# model with trends
model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs + insurance)
# model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs)
# summary table of the model
summary(model_with_trend)
## trying the transformation on trends
#with_trends_full %>% View
# trend 1
suvs_trends <- read_csv("trucks_2004_2011.csv")
names1<- names(suvs_trends)
suvs_trends <- suvs_trends %>%
rename(suvs = names1[2],
Period = Month) %>%
mutate(suvs = (suvs-suvs[1])/max(suvs))
# trend 2
insurance_trends <- read_csv("auto_insurance.csv")
names2 <- names(insurance_trends)
insurance_trends <- insurance_trends %>%
rename(insurance = names2[2],
Period = Month) %>%
mutate(insurance=(insurance-insurance[1])/100)
unadj_full <- sales %>% filter(Period <= "2011-07-01")
trends_full <- left_join(insurance_trends, suvs_trends, by = "Period") %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
#trends_full <- insurance_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
#trends_full <- suvs_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
with_trends_full <- left_join(unadj_full, trends_full, by = "Period") %>% rename(sales = Value)
with_trends_full$sales = log(as.numeric(with_trends_full$sales))
# apply lm(). lag() is used to capture y_t-1 and y_t-12
model1 <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12))
#the summary of the model
summary(model1)
# model with trends
model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs + insurance)
# model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs)
# summary table of the model
summary(model_with_trend)
## trying the transformation on trends
#with_trends_full %>% View
# trend 1
suvs_trends <- read_csv("suvs_2004_2011_all_cat.csv")
names1<- names(suvs_trends)
suvs_trends <- suvs_trends %>%
rename(suvs = names1[2],
Period = Month) %>%
mutate(suvs = (suvs-suvs[1])/max(suvs))
# trend 2
insurance_trends <- read_csv("auto_insurance.csv")
names2 <- names(insurance_trends)
insurance_trends <- insurance_trends %>%
rename(insurance = names2[2],
Period = Month) %>%
mutate(insurance=(insurance-insurance[1])/100)
# trend 3
trucks_trends <- read_csv("trucks_2004_2011.csv")
names3 <- names(trucks_trends)
trucks_trends <- trucks_trends %>%
rename(trucks = names3[2],
Period = Month) %>%
mutate(trucks=(trucks-trucks[1])/100)
unadj_full <- sales %>% filter(Period <= "2011-07-01")
trends_full <- left_join(insurance_trends, suvs_trends,trucks_trends, by = "Period") %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
#trends_full <- insurance_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
#trends_full <- suvs_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
with_trends_full <- left_join(unadj_full, trends_full, by = "Period") %>% rename(sales = Value)
with_trends_full$sales = log(as.numeric(with_trends_full$sales))
# apply lm(). lag() is used to capture y_t-1 and y_t-12
model1 <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12))
#the summary of the model
summary(model1)
# model with trends
model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs + insurance+ trucks)
# trend 1
suvs_trends <- read_csv("suvs_2004_2011_all_cat.csv")
names1<- names(suvs_trends)
suvs_trends <- suvs_trends %>%
rename(suvs = names1[2],
Period = Month) %>%
mutate(suvs = (suvs-suvs[1])/max(suvs))
# trend 2
insurance_trends <- read_csv("auto_insurance.csv")
names2 <- names(insurance_trends)
insurance_trends <- insurance_trends %>%
rename(insurance = names2[2],
Period = Month) %>%
mutate(insurance=(insurance-insurance[1])/100)
# trend 3
trucks_trends <- read_csv("trucks_2004_2011.csv")
names3 <- names(trucks_trends)
trucks_trends <- trucks_trends %>%
rename(trucks = names3[2],
Period = Month) %>%
mutate(trucks=(trucks-trucks[1])/100)
View(trucks_trends)
View(trucks_trends)
unadj_full <- sales %>% filter(Period <= "2011-07-01")
trends_full <- left_join(insurance_trends, suvs_trends,trucks_trends, by = "Period") %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
View(trends_full)
# trend 1
suvs_trends <- read_csv("suvs_2004_2011_all_cat.csv")
names1<- names(suvs_trends)
suvs_trends <- suvs_trends %>%
rename(suvs = names1[2],
Period = Month) %>%
mutate(suvs = (suvs-suvs[1])/max(suvs))
# trend 2
insurance_trends <- read_csv("auto_insurance.csv")
names2 <- names(insurance_trends)
insurance_trends <- insurance_trends %>%
rename(insurance = names2[2],
Period = Month) %>%
mutate(insurance=(insurance-insurance[1])/100)
# trend 3
trucks_trends <- read_csv("trucks_2004_2011.csv")
names3 <- names(trucks_trends)
trucks_trends <- trucks_trends %>%
rename(trucks = names3[2],
Period = Month) %>%
mutate(trucks=(trucks-trucks[1])/100)
unadj_full <- sales %>% filter(Period <= "2011-07-01")
# trends_full <- left_join(insurance_trends, suvs_trends, by = "Period") %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
trends_2 <- left_join(insurance_trends, suvs_trends, by = "Period")
trends_full <- left_join(trends_2, trucks_trends, by = "Period") %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
#trends_full <- insurance_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
#trends_full <- suvs_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
with_trends_full <- left_join(unadj_full, trends_full, by = "Period") %>% rename(sales = Value)
with_trends_full$sales = log(as.numeric(with_trends_full$sales))
# apply lm(). lag() is used to capture y_t-1 and y_t-12
model1 <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12))
#the summary of the model
summary(model1)
# model with trends
model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs + insurance+ trucks)
# model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs)
# summary table of the model
summary(model_with_trend)
## trying the transformation on trends
#with_trends_full %>% View
# trend 1
# suvs_trends <- read_csv("suvs_2004_2011_all_cat.csv")
# names1<- names(suvs_trends)
# suvs_trends <- suvs_trends %>%
#   rename(suvs = names1[2],
#          Period = Month) %>%
#   mutate(suvs = (suvs-suvs[1])/max(suvs))
# trend 2
insurance_trends <- read_csv("auto_insurance.csv")
names2 <- names(insurance_trends)
insurance_trends <- insurance_trends %>%
rename(insurance = names2[2],
Period = Month) %>%
mutate(insurance=(insurance-insurance[1])/100)
# trend 3
trucks_trends <- read_csv("trucks_2004_2011.csv")
names3 <- names(trucks_trends)
trucks_trends <- trucks_trends %>%
rename(trucks = names3[2],
Period = Month) %>%
mutate(trucks=(trucks-trucks[1])/100)
unadj_full <- sales %>% filter(Period <= "2011-07-01")
trends_full <- left_join(insurance_trends, trucks_trends, by = "Period") %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
# trends_2 <- left_join(insurance_trends, suvs_trends, by = "Period")
# trends_full <- left_join(trends_2, trucks_trends, by = "Period") %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
#trends_full <- insurance_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
#trends_full <- suvs_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
with_trends_full <- left_join(unadj_full, trends_full, by = "Period") %>% rename(sales = Value)
with_trends_full$sales = log(as.numeric(with_trends_full$sales))
# apply lm(). lag() is used to capture y_t-1 and y_t-12
model1 <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12))
#the summary of the model
summary(model1)
# model with trends
model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs + insurance+ trucks)
model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + insurance+ trucks)
# summary table of the model
summary(model_with_trend)
# trend 1
# suvs_trends <- read_csv("suvs_2004_2011_all_cat.csv")
# names1<- names(suvs_trends)
# suvs_trends <- suvs_trends %>%
#   rename(suvs = names1[2],
#          Period = Month) %>%
#   mutate(suvs = (suvs-suvs[1])/max(suvs))
# trend 2
insurance_trends <- read_csv("vehicle_insurance.csv")
names2 <- names(insurance_trends)
insurance_trends <- insurance_trends %>%
rename(insurance = names2[2],
Period = Month) %>%
mutate(insurance=(insurance-insurance[1])/100)
# trend 3
trucks_trends <- read_csv("trucks_2004_2011.csv")
names3 <- names(trucks_trends)
trucks_trends <- trucks_trends %>%
rename(trucks = names3[2],
Period = Month) %>%
mutate(trucks=(trucks-trucks[1])/100)
unadj_full <- sales %>% filter(Period <= "2011-07-01")
trends_full <- left_join(insurance_trends, trucks_trends, by = "Period") %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
# trends_2 <- left_join(insurance_trends, suvs_trends, by = "Period")
# trends_full <- left_join(trends_2, trucks_trends, by = "Period") %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
#trends_full <- insurance_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
#trends_full <- suvs_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
with_trends_full <- left_join(unadj_full, trends_full, by = "Period") %>% rename(sales = Value)
with_trends_full$sales = log(as.numeric(with_trends_full$sales))
# apply lm(). lag() is used to capture y_t-1 and y_t-12
model1 <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12))
#the summary of the model
summary(model1)
# model with trends
model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + insurance+ trucks)
# model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs)
# summary table of the model
summary(model_with_trend)
## trying the transformation on trends
#with_trends_full %>% View
# trend 1
# suvs_trends <- read_csv("suvs_2004_2011_all_cat.csv")
# names1<- names(suvs_trends)
# suvs_trends <- suvs_trends %>%
#   rename(suvs = names1[2],
#          Period = Month) %>%
#   mutate(suvs = (suvs-suvs[1])/max(suvs))
# trend 2
insurance_trends <- read_csv("auto_insurance_all.csv")
names2 <- names(insurance_trends)
insurance_trends <- insurance_trends %>%
rename(insurance = names2[2],
Period = Month) %>%
mutate(insurance=(insurance-insurance[1])/100)
# trend 3
trucks_trends <- read_csv("trucks_2004_2011.csv")
names3 <- names(trucks_trends)
trucks_trends <- trucks_trends %>%
rename(trucks = names3[2],
Period = Month) %>%
mutate(trucks=(trucks-trucks[1])/100)
unadj_full <- sales %>% filter(Period <= "2011-07-01")
trends_full <- left_join(insurance_trends, trucks_trends, by = "Period") %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
# trends_2 <- left_join(insurance_trends, suvs_trends, by = "Period")
# trends_full <- left_join(trends_2, trucks_trends, by = "Period") %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
#trends_full <- insurance_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
#trends_full <- suvs_trends %>% mutate(Period = as.Date(as.yearmon(Period, "%Y-%m")))
with_trends_full <- left_join(unadj_full, trends_full, by = "Period") %>% rename(sales = Value)
with_trends_full$sales = log(as.numeric(with_trends_full$sales))
# apply lm(). lag() is used to capture y_t-1 and y_t-12
model1 <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12))
#the summary of the model
summary(model1)
# model with trends
model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + insurance+ trucks)
# model_with_trend <- lm(data = with_trends_full, sales~lag(sales, 1)+lag(sales,12) + suvs)
# summary table of the model
summary(model_with_trend)
## trying the transformation on trends
#with_trends_full %>% View
